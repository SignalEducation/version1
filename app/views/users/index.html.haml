.row
  .col-sm-12
    .page-header
      %h1=t('views.users.index.h1')
.row
  .col-sm-12
    =will_paginate @users, renderer: BootstrapPagination::Rails
    %table.table.table-striped.table-bordered
      %tr
        %th
          =t('views.users.form.full_name')
          %br/
          =t('views.users.form.email')
        %th=t('views.users.form.active')
        %th=t('views.users.form.password_reset_requested_at')
        %th=t('views.users.form.password_reset_at')
        %th=t('views.users.form.stripe_customer_id')
        %th=t('views.users.form.corporate_customer_id')
        %th=t('views.users.form.corporate_customer_user_group_id')
        %th
      -user_group_id_tracker = nil
      -@users.each do |user|
        -if user.user_group_id != user_group_id_tracker
          -user_group_id_tracker = user.user_group_id
          %tr
            %td{colspan: 8}
              %h2=user.user_group.try(:name)
        %tr
          %td
            =link_to(user.full_name, user, title: t('views.general.view_tooltip'))
            %br/
            =link_to(user.email, user, title: t('views.general.view_tooltip'))
          %td=link_to(tick_or_cross(user.active), user, title: t('views.general.view_tooltip'))
          %td=link_to(user.password_reset_requested_at.to_s, user, title: t('views.general.view_tooltip'))
          %td=link_to(user.password_reset_at.to_s, user, title: t('views.general.view_tooltip'))
          %td=link_to(user.stripe_customer_id, user, title: t('views.general.view_tooltip'))
          %td=#link_to(user.corporate_customer.try(:name), user, title: t('views.general.view_tooltip'))
          %td=#link_to(user.corporate_customer_user_group.try(:name), user, title: t('views.general.view_tooltip'))

          %td
            -#=link_to t('views.general.view'), user
            =link_to t('views.general.edit'), edit_user_url(user), class: 'btn btn-info btn-xs'
            -if user.destroyable?
              =link_to t('views.general.delete'), user, method: :delete, data: { confirm: t('views.general.delete_confirmation') }, class: 'btn btn-danger btn-xs'
.row
  .col-sm-12
    =link_to t('views.general.new'), new_user_url, class: 'btn btn-success', title: t('views.general.new_tooltip')
