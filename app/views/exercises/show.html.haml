%main
  %article.dashboard.bg-gray5
    .container
      %header
        %h1.h1-hero.pt-5
          =@exercise.product.name


      %section.pb-md-6.pt-4
        %article.card.mb-5
          .card-body.card-body-sm
            .row
              .col-md-8
                %h3.text-gray2
                  %span.mr-1
                    ="Status: "
                    =@exercise.state

                %p.mb-1
                  Submitted on
                  %span=humanize_datetime_full(@exercise.submitted_on)

              .col-md-4.text-md-right
                -if @exercise.submission.present?
                  =link_to 'Download Submission', @exercise.submission.url, class: 'btn btn-primary btn-sm', target: '_blank'
                -if @exercise.correction.present?
                  =link_to 'Download Response', @exercise.correction.url, class: 'btn btn-primary btn-sm', target: '_blank'


-if flash[:success]
  :javascript
    dataLayer = [];
    dataLayer.push({
      'ecommerce': {
        'purchase': {
          'actionField': {
            'id': "#{@exercise.product.id}",
            'revenue': "#{@exercise.product.price}"
          },
          'products': [{
            'name': "#{@exercise.product.name}",
            'id': "#{@exercise.product.id}",
            'price': "#{@exercise.product.price}",
            'brand': "#{@exercise.product.mock_exam.subject_course.exam_body.name}",
            'category': 'Preparation',
            'quantity': 1
            }]
        }
      },
    'event':'ecomSuccess'}
    );
