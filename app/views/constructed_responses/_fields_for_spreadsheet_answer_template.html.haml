#spreadsheet_editor.editors.l-margin-top
  %h6='Answer Template Spreadsheet Editor'
  =scenario_answer_template.hidden_field :text_content

  #spreadsheet{style: 'width: 100%;'}


:javascript

  function onChange() {
    var data = spreadsheet.toJSON();
    var json = JSON.stringify(data, null, 2);
    $("#course_module_element_constructed_response_attributes_scenario_attributes_scenario_questions_attributes_#{scenario_question.options[:child_index]}_scenario_answer_templates_attributes_#{scenario_answer_template.options[:child_index]}_text_content").val(json);
  }

  var storedJson = $("#course_module_element_constructed_response_attributes_scenario_attributes_scenario_questions_attributes_#{scenario_question.options[:child_index]}_scenario_answer_templates_attributes_#{scenario_answer_template.options[:child_index]}_text_content").val();

  $("#spreadsheet").kendoSpreadsheet({sheetsbar: false, change: onChange});
  var spreadsheet = $("#spreadsheet").data("kendoSpreadsheet");

  if (storedJson != '') {
    var paredJson = JSON.parse(storedJson);
    spreadsheet.fromJSON(paredJson);
  }


