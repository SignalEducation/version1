.l-section-small.is-bg-asphalt
  .l-wrap
    .container-fluid
      .row.l-margin-bottom
        .col-md-12.text-center
          %h1.l-margin-bottom.l-margin-top.h-separator.h-separator-center{style: 'letter-spacing:1.5px;'}
            =@course_section.name


      .row.l-margin-bottom
        .col-md-12
          =link_to t('views.course_modules.new.h1'), course_modules_url(@subject_course), class: 'btn btn-cyan'
          =link_to t('views.subject_courses.reorder'), course_modules_order_url(@subject_course), class: 'btn btn-cyan'

      .row.l-margin-top.l-margin-bottom
        .col-md-12.l-margin-top
          .ol.sortable-area
            -@course_section.course_modules.all_in_order.each do |course_module|
              .li.l-margin-bottom-big
                .table-box
                  .table-responsive
                    .col-md-9.l-margin-bottom
                      %h2=course_module.name.to_s.truncate(50)
                    .col-md-3
                      .pull-right
                        =course_module.category
                        &#160;
                        &#160;
                        =tick_or_cross(course_module.active)
                    %table.table.sorted_table{data: {destination: course_module_elements_url}, id: course_module.id, style: 'font-size: 18px;'}
                      %thead
                        %tr
                          %th Name
                          %th Active
                          %th Trial
                          %th Type
                          %th
                          %th
                          %th
                      %tbody
                        -course_module.children.all_in_order.each do |cme|
                          %tr{id: cme.id, data: {parent: course_module.id, destination: course_module_elements_url}}
                            %td
                              =cme.name.to_s
                            %td
                              =tick_or_cross(cme.active)
                            %td
                              =tick_or_cross(cme.available_on_trial)
                            %td
                              =cme.type_name
                            %td
                              =link_to t('views.general.edit'), edit_course_module_element_url(cme.id), class: 'btn btn-small btn-purple'
                              =link_to t('views.course_module_elements.show.preview'), course_url(cme.course_module.subject_course.name_url, cme.course_module.name_url, cme.name_url, ), class: 'btn btn-small btn-orange', target: '_blank'
                              -unless cme.active
                                =link_to 'Activate', new_content_activation_url(type: cme.class, id: cme.id), class: 'btn btn-green btn-small'
                              -if cme.destroyable?
                                =link_to t('views.general.delete'), cme, method: :delete, data: { confirm: t('views.general.delete_confirmation') }, class: 'btn btn-red btn-small'
                            %td
                              %span.glyphicon.glyphicon-sort{title: t('views.general.drag_to_reorder')}


                    .col-md-6
                      =link_to t('views.course_module_elements.form.new_video'), new_course_module_element_url(type: 'video', cm_id: course_module.id), class: 'btn btn-purple'
                      =link_to t('views.course_module_elements.form.new_quiz'), new_course_module_element_url(type: 'quiz', cm_id: course_module.id), class: 'btn btn-purple'
                      =link_to t('views.course_module_elements.form.new_constructed_response'), new_course_module_element_url(type: 'constructed_response', cm_id: course_module.id), class: 'btn btn-purple'
                    .col-md-6
                      .pull-right
                        =link_to t('views.course_modules.edit.h1'), edit_course_module_url(course_module), class: 'btn btn-purple'
                        =link_to I18n.t('views.course_modules.index.delete'), course_module, method: :delete, data: { confirm: t('views.general.delete_confirmation') }, class: 'btn btn-red'

