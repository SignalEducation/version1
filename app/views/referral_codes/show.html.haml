-if @referral_code.referred_signups.count >= 1

  .corporate-box-item.chart-box
    .row.l-margin-bottom-big
      .col-md-6
        %h2.letter-space-wide Referral Program
      .col-md-6.chart-legend.text-right
        .color-circle.color-red.text-inline
        %p.text-inline.font-small Initial Referrals
        .color-circle.color-cyan.text-inline
        %p.text-inline.font-small Paying Referrals
    .row.l-margin-bottom
      %canvas#canvas{height:"300", width:"790"}




  .rows
    .col-sm-8.col-sm-offset-2
      %h2="#{t('views.users.show.tabs.referral_code')}: #{@user.referral_code.code}"
      .well.well-sm
        .row
          .col-sm-10
            %p=t('views.users.show.number_of_referred_users_last_month')
          .col-sm-2
            %p.pull-right
              =@user.referral_code.payed_referred_signups.last_month.count

        .row
          .col-sm-10
            %p=t('views.users.show.number_of_referred_users_this_month')
          .col-sm-2
            %p.pull-right
              =@user.referral_code.payed_referred_signups.this_month.count

    .container-fluid
      .row.l-margin-bottom#thank-you-message
        .col-md-12.text-center
          %h2.l-margin-bottom.l-margin-top.text-center.h-separator.h-separator-center{style: 'letter-spacing:1.5px;'}
            Invite friends to LearnSignal and get a discount off your subscription enrollment
        .col-md-10.col-md-offset-1.l-margin-bottom-6x
          .corporate-box-item
            .row
              .col-md-12
                %p.text-center{style: 'text-align: center;  letter-spacing: 0.5px;'}
                  Refer 5 new paying users to LearnSignal each month, we will give you a months free subscription.
                .form-group
                  =form_tag(referral_codes_path, authenticity_token: true, id: 'referral-code-form', role: 'form',  data: {type: 'json'}, class: 'form-horizontal', remote: true) do
                    .row
                      .col-sm-10.col-sm-offset-1
                        =text_field_tag :code, @user.referral_code ? referral_code_sharing_url(@user.referral_code) : '', class: 'form-control', readonly: true
                      %br/
                      .col-sm-4
                        %a.btn
                          =t('views.referral_codes.modal.copy')
                      .col-sm-4
                        %a.btn.btn-secondary{ href: "#"}
                          =t('views.referral_codes.modal.share')
                      .col-sm-4
                        %a.btn{href: "#"}
                          =t('views.referral_codes.modal.tweet')



-else
  .l-section-small.is-bg-asphalt
    .l-wrap
      .container-fluid
        .row.l-margin-bottom
          .col-md-12.l-margin-bottom-6x
            .corporate-box-item
              .container-fluid
                .row
                  .col-md-12
                    %p.h4.text-center.l-margin-bottom-big
                      Invite friends to LearnSignal and get a discount off you subscription!

                .row
                  .col-md-12
                    %p.text-center{style: 'text-align: center;  letter-spacing: 0.5px;'}
                      If you refer 5 friends each month you will earn â‚¬29.99 off your next subscription fee

:javascript
    var randomScalingFactor = function(){ return Math.round(Math.random()*100)};
    var months = #{@labels},
        initial_referrals_this_month = #{@initial_referrals_this_month},
        initial_referrals_one_month_ago = #{@initial_referrals_one_month_ago},
        initial_referrals_two_months_ago = #{@initial_referrals_two_months_ago},
        initial_referrals_three_months_ago = #{@initial_referrals_three_months_ago},
        converted_referrals_this_month = #{@converted_referrals_this_month},
        converted_referrals_one_month_ago = #{@converted_referrals_one_month_ago},
        converted_referrals_two_months_ago = #{@converted_referrals_two_months_ago},
        converted_referrals_three_months_ago = #{@converted_referrals_three_months_ago};

    var lineChartData = {
      labels : months,
      datasets : [
        {
          label: "Initial Referrals",
          fillColor : "rgba(220,220,220,0)",
          strokeColor : "#EE5457",
          pointColor : "#EE5457",
          pointStrokeColor : "#EE5457",
          pointHighlightFill : "#fff",
          pointHighlightStroke : "rgba(220,220,220,1)",
          data : [initial_referrals_three_months_ago,initial_referrals_two_months_ago,initial_referrals_one_month_ago,initial_referrals_this_month]
        },
        {
          label: "Paying Referrals",
          fillColor : "rgba(62,185,206,0.2)",
          strokeColor : "rgba(62,185,206,1)",
          pointColor : "rgba(62,185,206,1)",
          //pointStrokeColor : "#fff",
          pointHighlightFill : "#fff",
          pointHighlightStroke : "rgba(151,187,205,1)",
          data : [converted_referrals_three_months_ago,converted_referrals_two_months_ago,converted_referrals_one_month_ago,converted_referrals_this_month]
        }
      ]
    }

    window.onload = function(){
      var ctx = document.getElementById("canvas").getContext("2d");
      window.myLine = new Chart(ctx).Line(lineChartData, {
        responsive: true,scaleShowVerticalLines: false,datasetStrokeWidth : 3,scaleGridLineColor : "rgba(0,0,0,.1)",
        scaleOverride: true, scaleStartValue: 0, scaleStepWidth: 10, scaleSteps: 10,scaleShowLabels: true
      });
    }

    $("#menu-toggle").click(function(e) {
      e.preventDefault();
      $("#wrapper").toggleClass("toggled");
    });
