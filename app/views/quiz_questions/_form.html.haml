=form_for @quiz_question, html: {class: 'form-horizontal', role: 'form'} do |f|
  .row
    .col-sm-12
      .well.well-sm
        %h2 Question
        .form-group
          =f.label :difficulty_level, class: 'control-label col-sm-2'
          .col-sm-10
            =f.select :difficulty_level, ApplicationController::DIFFICULTY_LEVEL_NAMES, {prompt: t('views.general.select')}, {class: 'form-control'}
            %br/
          =f.fields_for :quiz_contents do |c|
            =c.label :text_content, t('views.quiz_questions.form.question_text'), class: 'control-label col-sm-2'
            .col-sm-10.question_contents
              .question_content_block
                =c.text_area :text_content, placeholder: t('views.quiz_questions.form.text_content_placeholder'), class: 'form-control', rows: 6
                .btn-group{role: 'group', aria: {label: 'add and remove buttons'}}
                  =link_to '#', class: 'btn btn-default', onclick: "addQuestionContent($(this)); return false;" do
                    %span.glyphicon.glyphicon-plus
                  =link_to '#',class: 'btn btn-default', onclick: "removeContent($(this)); return false;" do
                    %span.glyphicon.glyphicon-minus
  =f.fields_for :quiz_answers do
    =render partial: 'answers_form', locals: {f: f}

  %p
    =f.submit t('views.general.save'), class: 'btn btn-success'
    =t('views.general.or')
    =link_to t('views.general.cancel'), edit_course_module_element_url(@quiz_question.course_module_element_quiz.course_module_element_id)

:javascript
   // todo Set the default value for the radio buttons
  function addQuestionContent(me) {
    var theTime = (new Date).getTime();
    var position = $('.question_contents').children().index(me.parent().parent());
    var theClone = me.parent().parent().clone();
    console.log(theClone.find('textarea'));
    theClone.find('textarea').attr('id', 'quiz_question_quiz_contents_attributes_' + theTime + '_text_content');
    theClone.find('textarea').attr('name', 'quiz_question[quiz_contents_attributes][' + theTime + '][text_content]');
    theClone.find('textarea').val('');
    console.log(theClone.find('textarea'));
    $('.question_contents .question_content_block:nth-child(' + (position + 1) + ')').after(theClone);
  }

  function removeContent(me) {
    if (me.parent().parent().is(':first-child')) {
      alert('Sorry you cannot delete the last text block');
    } else {
      if (confirm('Are you sure?')) {
        me.parent().parent().remove();
      }
    }
  }