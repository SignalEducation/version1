.row
  .col-sm-12
    %h2.no-top-gap=@course_module.name
    =render partial: 'shared/tutor_breadcrumbs', locals: {the_thing: @course_module}
    .well.well-sm=sanitizer @course_module.description
    %p
      =t('views.course_modules.form.tutor_id') + ':'
      =@course_module.tutor.full_name
    %p
      =t('views.course_module_element_quizzes.form.best_possible_score_first_attempt') + ':'
      =@course_module.course_module_element_quizzes.sum(:best_possible_score_first_attempt)
      %br/
      =t('views.course_module_element_quizzes.form.best_possible_score_retry') + ':'
      =@course_module.course_module_element_quizzes.sum(:best_possible_score_retry)
    .row
      .col-sm-4
        =t('views.general.time')
        =seconds_to_time(@course_module.estimated_time_in_seconds)
      .col-sm-4.text-center
      .col-sm-4.text-right
        -if @course_module.active
          .label.label-success Active
        -else
          .label.label-danger Inactive
    %br/
    .row
      .col-sm-12
        %p
          =link_to t('views.general.edit'), edit_course_module_url(id: @course_module.id), title: t('views.general.edit_tooltip'), class: 'btn btn-info btn-xs'

.row
  .col-sm-12
    %h3=t('views.course_modules.form.course_module_elements')
    %table.table.table-striped.sorted_table{data: {destination: course_module_elements_url}}
      %tbody
        -@course_module.course_module_elements.each do |cme|
          %tr{id: cme.id}
            %td=cme.name
            %td
              -if cme.active
                %span.label.label-success=t('views.general.active')
              -else
                %span.label.label-default=t('views.general.inactive')
            %td
              -if cme.course_module_element_video
                Video
              -elsif cme.course_module_element_quiz
                Quiz
              -else
                Unknown
            %td.text-right=seconds_to_time(cme.estimated_time_in_seconds)
            %td
              =link_to t('views.general.edit'), edit_course_module_element_url(cme.id), class: 'btn btn-xs btn-info'
              -if cme.is_video || cme.course_module_element_quiz.enough_questions?
                =link_to t('views.course_module_elements.show.preview'), cme, class: 'btn btn-xs btn-info'
              -else
                .label.label-warning=t('views.course_modules.show.add_more_questions')
              -if cme.destroyable? && !cme.active
                =link_to t('views.general.delete'), cme, method: :delete, data: { confirm: t('views.general.delete_confirmation') }, class: 'btn btn-danger btn-xs'
            %td
              %span.glyphicon.glyphicon-sort{title: t('views.general.drag_to_reorder')}
    %p
      =link_to t('views.course_module_elements.form.new_video'), new_course_module_element_url(type: 'video', cm_id: @course_module.id), class: 'btn btn-success'
      =link_to t('views.course_module_elements.form.new_quiz'), new_course_module_element_url(type: 'quiz', cm_id: @course_module.id), class: 'btn btn-success'

    =render partial: 'course_module_jumbo_quizzes/show'
