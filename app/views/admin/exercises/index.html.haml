.container
  %header.management-console-section
    %h1
      =t('views.exercises.admin.index.h1')

  %section.pb-7
    .admin-nav
      %ul.admin-nav-block
        %li{style: 'margin-left: 4%; margin-right: 4%;'}
          =link_to 'Submitted Exercises', admin_exercises_path
        %li{style: 'margin-left: 4%; margin-right: 4%;'}
          =link_to 'Correcting in Progress', admin_exercises_path(state: :correcting)
        %li{style: 'margin-left: 4%; margin-right: 4%;'}
          =link_to 'Returned Exercises', admin_exercises_path(state: :returned)
        %li{style: 'margin-left: 4%; margin-right: 4%;'}
          =link_to 'All Exercises', admin_exercises_path(state: :all)

    .row
      .col-sm-12
        .box-item.table-box
          .row
            .col-sm
              .search-container.float-right
                =form_tag(admin_search_exercises_url, role: 'form', class: 'form-inline') do
                  =text_field_tag :search_term, params[:search_term], class: 'form-control', placeholder: t('views.general.search')
                  %button{type: "submit"}
                    %i{:role => "img", class: 'budicon-search-list'}
          .table-responsive.pt-4
            =will_paginate @exercises, renderer: BootstrapPagination::Rails
            %table.table
              %thead
                %tr
                  %th=t('views.exercises.admin.index.name')
                  %th=t('views.exercises.admin.index.email')
                  %th=t('views.exercises.admin.index.state')
                  %th=t('views.exercises.admin.index.submitted_on')
                  %th=t('views.exercises.admin.index.corrected_on')
                  %th=t('views.exercises.admin.index.returned_on')
                  %th
              %tbody
                -@exercises.each do |exercise|
                  %tr
                    %td=exercise.user.name
                    %td=exercise.user.email
                    %td=exercise.state
                    %td=exercise.submitted_on&.strftime('%d/%m/%y %H:%m')
                    %td=exercise.corrected_on&.strftime('%d/%m/%y %H:%m')
                    %td=exercise.returned_on&.strftime('%d/%m/%y %H:%m')
                    %td
                      =link_to t('views.general.edit'), edit_admin_exercise_path(exercise), class: 'btn btn-primary btn-xs'
                      =link_to t('views.general.view'), admin_exercise_path(exercise), class: 'btn btn-secondary btn-xs'
                      -if exercise.corrector_id.present?
                        %span= "Claimed By (#{exercise.corrector.name})"
                      -else
                        =link_to 'Claim', admin_exercise_path(exercise, exercise: { corrector_id: current_user.id }), method: :patch, class: 'btn btn-secondary btn-xs'

